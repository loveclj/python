#!/usr/bin/env python
# encoding: utf-8

"""
@author: lizhifeng
@contact: lizhifeng2009@126.com
@site: 
@file: similarity.py
@time: 7/7/16 4:08 PM
"""

def jeccard_distance(s1, s2, demenssion=881):
    n1 = 0
    n2 = 0
    union = 0
    for i in range(demenssion):
        if s1[i] == '1':
            n1 += 1

        if s2[i] == '1':
            n2 += 1

        if s1[i] == '1' or s2[i] == '1':
            union += 1

    return float(n1 + n2 - union)/union


def find_min_distance(s, distance_fun):
    fp = open('chemical_data.text', 'r')
    max_similarity = 0
    k = 0
    while True:
        line = fp.readline()
        if not line:
            break

        cid, fingerprint = line.strip('\n').split(',')
        similarity = distance_fun(s, fingerprint)
        print similarity
        # if similarity - 1 > -0.00001:
        #     print "same chemical", cid
        # elif similarity > 0.8:
        #     k += 1
        # elif similarity > max_similarity:
        #     max_similarity = similarity
        #     print "change: cid:", cid, "similarity:", max_similarity
    print k


if __name__ == '__main__':
    s1 = "11100000011100111011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101100000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000001111000000000000100000000000000000000000000000000100000001000110000011001000000000100001100011100000010000011110000000000000000000000100010000000000000100101010100100101000000000000100000100000000000000000001000010000001000000000000010001000100010000001000010000110010010001000100010000110000000110010110000001101000111010001100101000010000000001000011010001001011000000010110010001100100000100111000101000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000"
    s2 = "11100000011110111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101100000000000000000000000000000001111000100000000000000000000000000000000000000000000000000000000000000000000011111000000000000000000000001110000000000000100000000000000000000000000000000110000001000110000010001101100000100001111111111000010010111110011000001000000000000101000000000001000110110011001110110010000000000100000101000000000101101001100010001001010100000000010011101100010100000001110000111010010011000100010000110100011100010110000001001100110010001100101000010000000001000011010001001000000000010110010001100100000100111000100001000000001000000000011100000000000000000000000100000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000"

    find_min_distance(s1, jeccard_distance)